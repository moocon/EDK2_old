<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<style type="text/css">
  <!--
  .main-title, .main-details {
    font-size: small;
  }
  
  .main-details {
    margin-top: 0.19in;
    margin-bottom: 0.19in
  }
  
  .main-title {
    font-weight: bold;
    margin-top: 0in;
    margin-bottom: 0.08in;
    border-bottom: thin solid black;
  }

  .build-step-title {
    font-weight: bold;
    margin-top: 0.19in;
    margin-bottom: 0.19in
  }
  
  .build-step-details {
  }

  .monospace, .build-step-code {
    font-family: "courier new", "courier", "monospace";
  }

  .build-step-code {
    border: 1px dashed;
    margin-right: 0.25in;
    padding: 2pt 4pt 2pt 4pt;
    background-color: #F0F0F0;
  }
  
  .build-step-details, .build-step-code, .build-step-title {
    font-size: small;
    margin-left: 0.25in;
  }
  
  table.build-step-details td {
    border-style: hidden;
  }
  
  img.in-text {
    vertical-align: top;
  }
  -->
</style>

<h2 class="main-title">
  Step-by-step (walk-throughs) for building with edk2
</h2>

<p class="main-details">
  This page contains some step-by-step guides in an attempt to give
  a highly detailed description of how to set up building on an edk2
  system.&nbsp;
  A few different operating systems are targeted.&nbsp;
  It is hoped that these examples can either provide exact steps for
  setting up an edk2 build environment.&nbsp;
  If instructions are not available for your exact system configuration,
  you may still be able to tweak the instructions to work on your
  system.
</p>

<!--
 #
 # Getting started for unix-like systems
 #
-->
<h2 class="main-title">
  Getting started for UNIX-like operating systems
</h2>

<p class="build-step-details">
  These instructions will be written as a series of commands executed from
  a command terminal.
</p>

<p class="build-step-details">
  Often these instructions will contain a command which needs to be
  executed in the terminal window.&nbsp; For example:
</p>

<pre class="build-step-code">
bash$ <b>echo this bold text is a sample command</b>
</pre>

<p class="build-step-details">
  To execute this command, highlight the
  <font class="monospace"><b>bold</b></font>
  text of the 
  command in your web browser.&nbsp;
  Most web browsers should be able to copy the text by selecting <i>Copy</i>
  under the <i>Edit</i> menu.&nbsp;
  Now, change back to the terminal application, and there should be a
  <i>Paste</i> operation under the <i>Edit</i> menu.&nbsp;
  After pasting the command into the shell, you may need to press the
  <i>enter</i> or <i>return</i> key to execute the command.&nbsp;
</p>
<p class="build-step-details">
  Of course, there may be other ways to copy and paste the command into
  the terminal which are specific to the windowing environment and
  applications that you are using.&nbsp;
  If all else fails, however, you can type the command by hand.
</p>

<p class="build-step-details">
  Some commands are very long, and we use the backslash character (\) to
  tell the shell program that the command is not finished.&nbsp; For example:
</p>

<pre class="build-step-code">
bash$ <b>echo this bold text is a sample command \
        which is broken into two lines</b>
</pre>

<p class="build-step-details">
  When you copy and paste, make sure you include all lines of the command
  (including the backslash (\) characters).&nbsp;
  If you are typing the command, you can remove the backslash character (\)
  and combine the lines into a single line if you prefer.
</p>

<p class="build-step-details">
  If a command starts with the <font class="monospace"><b>sudo</b></font>
  command, then you may be prompted for your user password.&nbsp;
  This will be the same password as you used to login to the system.
</p>

<p class="build-step-details">
  For the purposes of this set of instructions, we will be using the following
  paths.&nbsp;
</p>

<table class="build-step-details">
  <tr>
    <td>
      <a href="https://edk2.tianocore.org">Edk2</a> source tree:
    </td>
    <td>
      <font class="monospace"><b>~/src/edk2</b></font>
    </td>
  </tr>
  <tr>
    <td>
      <a href="https://buildtools.tianocore.org">BaseTools</a> source tree:
    </td>
    <td>
      <font class="monospace"><b>~/src/BaseTools</b></font>
    </td>
  </tr>
  <tr>
    <td>
      GCC X64 cross-compiler installation:
    </td>
    <td>
      <font class="monospace"><b>~/programs/gcc/x64</b></font>
    </td>
  </tr>
</table>

<p class="build-step-details">
  You will need to change the commands if you want to use different
  locations, but this is not recommended unless you are sure that you
  know what you are doing.
</p>

<h2 class="main-title">
  Internet proxies
</h2>

<p class="build-step-details">
  If your network utilizes a firewall with a web proxy, then you may
  need to configure your proxy information for various command line
  applications to work.&nbsp;
  You may need to consult with your network administrator to find
  out the computer name and port to use for proxy setup.&nbsp;
  The following commands are common examples of how you would configure
  your proxy by setting an environment variable:
</p>

<pre class="build-step-code">
bash$ <b>export http_proxy=http://proxy.domain.com:proxy_port</b>
bash$ <b>export ftp_proxy=$http_proxy</b>
</pre>

<p class="build-step-details">
  To utilize the subversion source control command behind an internet
  firewall with a web proxy, you should configure the
  <font class="monospace">~/.subversion/servers</font> file.
</p>

<h2 class="main-title">
  Instructions for various UNIX-like systems
</h2>

<font size="2">
  <ul>
    <li><a href="#Fedora11">Fedora 11</a></li>
    <li><a href="#MacOSX10.5">Mac OS X 10.5</a> (Leopard)</li>
    <li><a href="#RHEL4">Red Hat Enterprise Linux 4 Desktop</a></li>
    <li><a href="#SLED10">SuSE Linux Enterprise 10 Desktop</a></li>
    <li><a href="#Ubuntu9.04">Ubuntu 9.04</a></li>
  </ul>
</font>

<h2 class="main-title">
  Intel ASL compiler
</h2>

<p class="build-step-details">
  Additionally, instructions are provided for
  <a href="#iasl">installing the Intel ASL</a>
  compiler for use with edk2.&nbsp;
  (This is not required for all edk2 developers.)
</p>

<!--
 #
 # Fedora 11
 #
-->
<h2 class="main-title">
  <a name="Fedora11"></a>
  Fedora 11
</h2>

<h3 class="build-step-title">
  Please note
</h3>

<p class="build-step-details">
  <ul>
    <li class="build-step-details">
      Fedora 11 is not officially supported or tested by the
      <a href="index.html">edk2</a>
      project at this time.
    </li>
    <li class="build-step-details">
      These instructions assume that the <i>Software Development</i>
      option was enabled during the Fedora installation.
    </li>
  </ul>
</p>

<h3 class="build-step-title">
  Open the <a href="http://www.gnome.org">GNOME</a> Terminal program
</h3>

<p class="build-step-details">
  These instructions will utilize Fedora's built in
  command shell (bash) via the <i>GNOME Terminal</i> application.&nbsp;
  To open the <i>Terminal</i> application, locate it under the
  <i>Applications</i> menu and the <i>System Tools</i> sub-menu.
</p>

<h3 class="build-step-title">
  Install MPFR library
</h3>

<p class="build-step-details">
  The MPFR library must be installed to allow the gcc
  cross compiler to be built.
</p>

<pre class="build-step-code">
bash$ <b>mkdir ~/src</b>
bash$ <b>cd ~/src</b>
bash$ <b>wget http://www.mpfr.org/mpfr-current/mpfr-2.4.1.tar.bz2</b>
bash$ <b>tar -jxf mpfr-2.4.1.tar.bz2</b>
bash$ <b>cd mpfr-2.4.1</b>
bash$ <b>./configure --prefix=/usr</b>
bash$ <b>make</b>
</pre>

<p class="build-step-details">
To install the library, you must be root.&nbsp; Therefore we
use 'su' to become the root user, for the 'make install' command.
</p>

<pre class="build-step-code">
bash$ <b>su</b>
bash$ <b>make install</b>
bash$ <b>exit</b>
</pre>

<h3 class="build-step-title">
  Continue with common instructions
</h3>

<p class="build-step-details">
  The remaining instructions are
  <a href="#UnixCommon">common for most UNIX-like systems</a>.
</p>

<!--
 #
 # MAC OS X 10.5
 #
-->
<h2 class="main-title">
  <a name="MacOSX10.5"></a>
  Mac OS X 10.5
</h2>

<h3 class="build-step-title">
  Xcode Tools
</h3>

<p class="build-step-details">
  The first step is to install the Apple Xcode
  development environment:<br>
  &nbsp;&nbsp;<a href="http://developer.apple.com/tools/xcode">http://developer.apple.com/tools/xcode</a>
</p>

<p class="build-step-details">
  To install Xcode, you must register as an Apple developer, and
  download the Xcode installation disk image (which is fairly large).&nbsp;
  These instructions were verified with Xcode 3.0.&nbsp;
  Within the Xcode Tools disk image, only the
  <font class="monospace">Xcode&nbsp;Tools.mpkg</font> package
  needs to be installed.
</p>

<h3 class="build-step-title">
  Open OS X Terminal program
</h3>

<p class="build-step-details">
  Past this point, the remaining instructions will utilize OS X's built in
  command shell (bash) via the <i>Terminal</i> application.&nbsp;
  To open the command terminal application, open <i>Finder</i>, then press the
  <img src="apple-command-key.gif" class="in-text" alt="Cmd" title="Command/Apple key" />-Shift-U
  key combination.&nbsp;
  (This opens the <i>Applications</i> => <i>Utilities</i> folder.)&nbsp;
  In the <i>Utilities</i> folder, you should see the <i>Terminal</i>
  application.
</p>


<h3 class="build-step-title">
  GMP &amp; MPFR (if behind a web proxy)
</h3>

<p class="build-step-details">
  The <a href="http://gmplib.org/">gmp</a> and
  <a href="http://www.mpfr.org/">mpfr</a> libraries are needed to build
  the gcc cross compiler at a later point in these instructions.&nbsp;
  Building these libraries on OS X can present some difficulties, so
  if you are not behind a network firewall, then consider using the
  macports project to install these libraries. (see below)&nbsp;
  Be sure to set the http_proxy and ftp_proxy environment variables
  before using the 'curl' commands below.
</p>

<pre class="build-step-code">
bash$ <b>mkdir ~/src</b>
bash$ <b>cd ~/src</b>
bash$ <b>curl --remote-name \
  ftp://ftp.gnu.org/gnu/gmp/gmp-4.2.2.tar.bz2</b>
bash$ <b>tar jxvf gmp-4.2.2.tar.bz2</b>
bash$ <b>cd gmp-4.2.2</b>
bash$ <b>./configure --prefix=/usr</b>
bash$ <b>make</b>
bash$ <b>make check</b>
bash$ <b>sudo make install</b>

Note: This might be needed for 64-bit machines if
      the MPFR configure fails below.
bash$ <b>export CFLAGS="-m64"</b>

bash$ <b>cd ~/src</b>
bash$ <b>curl --remote-name \
  http://www.mpfr.org/mpfr-current/mpfr-2.4.1.tar.bz2</b>
bash$ <b>tar -jxf mpfr-2.4.1.tar.bz2</b>
bash$ <b>cd mpfr-2.4.1</b>
bash$ <b>./configure --prefix=/usr</b>
bash$ <b>make</b>
bash$ <b>sudo make install</b>
</pre>


<h3 class="build-step-title">
  GMP &amp; MPFR via Macports (if not behind web proxy)
</h3>

<p class="build-step-details">
  If you are not behind a network firewall, then the
  <a href="http://www.macports.org/">http://www.macports.org</a>
  project can greatly simlify the installation of gmp &amp; mpfr.&nbsp;
  (Macports does not work easily with web proxies at this time.)
  After installing macports you should be able to simply run this
  command at the shell prompt.
</p>

<pre class="build-step-code">
bash$ <b>sudo port install gmp mpfr</b>
</pre>

<h3 class="build-step-title">
  Continue with common instructions
</h3>

<p class="build-step-details">
  The remaining instructions are
  <a href="#UnixCommon">common for most UNIX-like systems</a>.
</p>

<!--
 #
 # Red Hat Enterprise Linux 4 Desktop
 #
-->
<h2 class="main-title">
  <a name="RHEL4"></a>
  Red Hat Enterprise Linux 4 Desktop
</h2>

<h3 class="build-step-title">
  Coming soon...
</h3>

<!--
 #
 # SuSE Linux Enterprise 10 Desktop
 #
-->
<h2 class="main-title">
  <a name="SLED10"></a>
  SuSE Linux Enterprise 10 Desktop
</h2>

<h3 class="build-step-title">
  Coming soon...
</h3>


<!--
 #
 # Ubuntu 9.04
 #
-->
<h2 class="main-title">
  <a name="Ubuntu9.04"></a>
  Ubuntu 9.04
</h2>

<h3 class="build-step-title">
  Please note
</h3>

<p class="build-step-details">
  The Ubuntu platform is not officially supported or tested by the
  <a href="index.html">edk2</a>
  project at this time.
</p>

<h3 class="build-step-title">
  Open the <a href="http://www.gnome.org">GNOME</a> Terminal program
</h3>

<p class="build-step-details">
  These instructions will utilize Ubuntu's built in
  command shell (bash) via the <i>GNOME Terminal</i> application.&nbsp;
  To open the <i>Terminal</i> application, locate it under the
  <i>Applications</i> menu and the <i>Accessories</i> sub-menu.
</p>

<h3 class="build-step-title">
  Install required software from apt
</h3>

<p class="build-step-details">
  Several ubuntu packages will be needed to fully set up an edk2 build
  environment.&nbsp;
  In order to easily install all the requirements, you need to run
  this command.
</p>

<pre class="build-step-code">
bash$ <b>sudo apt-get install build-essential uuid-dev texinfo \
        texinfo bison flex libgmp3-dev libmpfr-dev subversion</b>
</pre>

<h3 class="build-step-title">
  Continue with common instructions
</h3>

<p class="build-step-details">
  The remaining instructions are
  <a href="#UnixCommon">common for most UNIX-like systems</a>.
</p>

<!--
 #
 # Common instruction unix-like systems
 #
-->
<h2 class="main-title">
  <a name="UnixCommon"></a>
  Common instructions for UNIX-like systems
</h2>

<p class="build-step-details">
  A significant portion of the steps are common on the various UNIX-like
  platforms.&nbsp;
  You should start with the instructions for the operating system that
  most closely matches your platform, and it will direct you here at the
  appropriate time.
</p>

<h3 class="build-step-title">
  Get and build the edk2 BaseTools
</h3>

<p class="build-step-details">
  We will now check out the BaseTools source code using subversion.&nbsp;
  (If you are behind a web proxy, then you may need to configure your proxy
  in the ~/.subversion/servers file.)&nbsp;
  We will tell subversion to use the 'guest' username on tianocore.org.&nbsp;
  The password for the 'guest' account is blank/empty.
</p>

<pre class="build-step-code">
bash$ <b>mkdir ~/src</b>
bash$ <b>cd ~/src</b>
bash$ <b>svn co \
  https://buildtools.tianocore.org/svn/buildtools/trunk/BaseTools \
  --username guest</b>
bash$ <b>make -C BaseTools</b>
</pre>

<h3 class="build-step-title">
  Build <a href="http://gcc.gnu.org">gcc</a> x64 UEFI cross compiler
</h3>

<p class="build-step-details">
  In order to build UEFI images for x64, you will need to build a
  cross-compiler build of gcc.&nbsp;
  This can take quite a while to complete, possibly several hours on
  older systems.&nbsp;
  But, a Python script has been provided to automate this build process.
</p>

<pre class="build-step-code">
Note: This is only needed if behind a internet firewall!
bash$ <b>export http_proxy=http://proxy.domain.com:proxy_port</b>
</pre>

<p class="build-step-details">
  To build gcc for x64, use these commands (this will take quite a while
  to complete):
</p>

<pre class="build-step-code">
bash$ <b>cd ~/src/BaseTools/gcc</b>
bash$ <b>./mingw-gcc-build.py --arch=x64 \
  --prefix=~/programs/gcc/x64</b>
</pre>

<h3 class="build-step-title">
  Get the edk2 source tree
</h3>

<pre class="build-step-code">
bash$ <b>cd ~/src</b>
bash$ <b>svn co \
  https://edk2.tianocore.org/svn/edk2/trunk/edk2 \
  --username guest</b>
</pre>

<h3 class="build-step-title">
  Setup build shell environment
</h3>

<pre class="build-step-code">
bash$ <b>cd ~/src/edk2</b>
bash$ <b>export EDK_TOOLS_PATH=~/src/BaseTools</b>
bash$ <b>. edksetup.sh BaseTools</b>
</pre>

<h3 class="build-step-title">
  Modify Conf files
</h3>

<p class="build-step-details">
  You will need to edit the Conf/tools_def.txt and Conf/target.txt files.&nbsp;
</p>

<p class="build-step-details">
  For the <i>Conf/tools_def.txt</i> file, search for all instances of:
</p>

<pre class="build-step-code">
DEF(UNIXGCC_X64_PETOOLS_PREFIX)/
</pre>

<p class="build-step-details">
  And replace it with:
</p>

<pre class="build-step-code">
ENV(HOME)/programs/gcc/x64/bin/x86_64-pc-mingw32-
</pre>

<p class="build-step-details">
  For the <i>Conf/target.txt</i> file, find the following lines:
</p>

<pre class="build-step-code">
ACTIVE_PLATFORM       = Nt32Pkg/Nt32Pkg.dsc
TARGET_ARCH           = IA32
TOOL_CHAIN_TAG        = MYTOOLS
</pre>

<p class="build-step-details">
  And change the cooresponding lines to match these:
</p>

<pre class="build-step-code">
ACTIVE_PLATFORM       = MdeModulePkg/MdeModulePkg.dsc
TARGET_ARCH           = X64
TOOL_CHAIN_TAG        = UNIXGCC
</pre>

<h3 class="build-step-title">
  Build Hello World!&nbsp; (and the rest of MdeModulePkg)
</h3>

<p class="build-step-details">
  Now you should be able to simply run the <i>build</i> command to compile
  the MdeModulePkg.
</p>

<pre class="build-step-code">
bash$ <b>build</b>
</pre>

<p class="build-step-details">
  As a tangible result of the build, you should have the HelloWorld UEFI
  X64 application.&nbsp;
  If you have a X64 UEFI system available to you, then this application
  should be able to run successfully under the shell.
</p>

<pre class="build-step-code">
bash$ <b>ls Build/MdeModule/DEBUG_UNIXGCC/X64/HelloWorld.efi</b>
</pre>

<!--
 #
 # Installing iasl
 #
-->
<h2 class="main-title">
  <a name="iasl"></a>
  Install the Intel ASL (iasl) compiler (OPTIONAL)
</h2>

<p class="build-step-details">
  The Intel ASL compiler is not required for all edk2 developers.&nbsp;
  For example, it is unlikely that UEFI Application or UEFI Driver builds
  will need an ASL compiler.&nbsp;
  But, if you are building an entire system firmware image, then you may
  need an ASL compiler.&nbsp;
  For example, the edk2 OVMF sample platform does require an ASL compiler
  in order to be built.
</p>

<p class="build-step-details">
  First, download the latest ACPI-CA release from
  <a href="http://www.acpica.org">http://www.acpica.org</a>.&nbsp;
  At this time, the latest versions of ACPI-CA are not building on Mac OS X,
  so please use the release from 20081031 instead.
</p>

<pre class="build-step-code">
bash$ <b>cd ~/src</b>
bash$ <b>wget http://www.acpica.org/download/acpica-unix-20090521.tar.gz</b>
bash$ <b>tar -zxf acpica-unix-20090521.tar.gz</b>
bash$ <b>make -C acpica-unix-20090521/compiler</b>
bash$ <b>ln -s ~/src/acpica-unix-20090521/compiler/iasl ~/programs/iasl</b>
</pre>


