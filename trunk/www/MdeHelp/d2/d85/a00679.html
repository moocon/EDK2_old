<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MdePkg[ALL]: EFI_VARIABLE_AUTHENTICATION Struct Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="../../functions.html"><span>Data&nbsp;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>EFI_VARIABLE_AUTHENTICATION Struct Reference</h1><!-- doxytag: class="EFI_VARIABLE_AUTHENTICATION" --><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Fields</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d0/d90/a01059.html#95df6cdb32afc350ff070f2fe8a54a67">UINT64</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d85/a00679.html#fc0e2555963a8a3046a17ddd2c09350e">MonotonicCount</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc3/a00284.html">WIN_CERTIFICATE_UEFI_GUID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d85/a00679.html#69728a7870afdec21157504b489a6e1b">AuthInfo</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
AuthInfo is a WIN_CERTIFICATE using the wCertificateType WIN_CERTIFICATE_UEFI_GUID and the CertType EFI_CERT_TYPE_RSA2048_SHA256. If the attribute specifies authenticated access, then the Data buffer should begin with an authentication descriptor prior to the data payload and DataSize should reflect the the data.and descriptor size. The caller shall digest the Monotonic Count value and the associated data for the variable update using the SHA-256 1-way hash algorithm. The ensuing the 32-byte digest will be signed using the private key associated w/ the public/private 2048-bit RSA key-pair. The WIN_CERTIFICATE shall be used to describe the signature of the Variable data *Data. In addition, the signature will also include the MonotonicCount value to guard against replay attacks <hr><h2>Field Documentation</h2>
<a class="anchor" name="69728a7870afdec21157504b489a6e1b"></a><!-- doxytag: member="EFI_VARIABLE_AUTHENTICATION::AuthInfo" ref="69728a7870afdec21157504b489a6e1b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc3/a00284.html">WIN_CERTIFICATE_UEFI_GUID</a> <a class="el" href="../../d2/d85/a00679.html#69728a7870afdec21157504b489a6e1b">EFI_VARIABLE_AUTHENTICATION::AuthInfo</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Provides the authorization for the variable access. It is a signature across the variable data and the Monotonic Count value. Caller uses Private key that is associated with a public key that has been provisioned via the key exchange. 
</div>
</div><p>
<a class="anchor" name="fc0e2555963a8a3046a17ddd2c09350e"></a><!-- doxytag: member="EFI_VARIABLE_AUTHENTICATION::MonotonicCount" ref="fc0e2555963a8a3046a17ddd2c09350e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d90/a01059.html#95df6cdb32afc350ff070f2fe8a54a67">UINT64</a> <a class="el" href="../../d2/d85/a00679.html#fc0e2555963a8a3046a17ddd2c09350e">EFI_VARIABLE_AUTHENTICATION::MonotonicCount</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Included in the signature of AuthInfo.Used to ensure freshness/no replay. Incremented during each "Write" access. 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Aug 7 13:54:50 2009 for MdePkg[ALL] by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7.1 </small></address>
</body>
</html>
